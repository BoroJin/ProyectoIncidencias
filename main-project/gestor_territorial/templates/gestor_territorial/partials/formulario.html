<form action="{% url 'crear_incidencia' %}" method="post">
    {% csrf_token %}
    <input type="hidden" name="lat" value="{{ latitud }}">
    <input type="hidden" name="lng" value="{{ longitud }}">

    <!-- Campos siempre visibles -->
    <div class="form-group">
        <label for="titulo">Título</label>
        <input class="form-control" type="text" name="titulo" id="titulo" placeholder="Escriba el título">
    </div>

    <div class="form-group">
        <label for="descripcion">Descripción</label>
        <textarea class="form-control" name="descripcion" id="descripcion" rows="4" placeholder="Describa la incidencia"></textarea>
    </div>

    <div class="form-group">
        <label for="urgencia">Urgencia</label>
        <select class="form-control" name="urgencia" id="urgencia">
            <option value="baja">Baja</option>
            <option value="media" selected>Media</option>
            <option value="alta">Alta</option>
            <option value="critica">Crítica</option>
        </select>
    </div>

    <!-- Campos dinámicos -->
    {% for campo in campos %}
        <div class="form-group">
            <label for="{{ campo.id }}">{{ campo.nombre }}</label>

            {% if campo.tipo == 'text' %}
                <input class="form-control" type="text" name="{{ campo.id }}" id="{{ campo.id }}" placeholder="Escriba aquí">
            {% elif campo.tipo == 'checkbox' %}
                {% for opcion in campo.opciones.all %}
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="{{ campo.id }}_{{ opcion.valor }}" id="{{ campo.id }}_{{ opcion.valor }}" value="{{ opcion.valor }}">
                        <label class="form-check-label" for="{{ campo.id }}_{{ opcion.valor }}">{{ opcion.valor }}</label>
                    </div>
                {% endfor %}
            {% elif campo.tipo == 'select' %}
                <select class="form-control" name="{{ campo.id }}" id="{{ campo.id }}">
                    {% for opcion in campo.opciones.all %}
                        <option value="{{ opcion.valor }}">{{ opcion.valor }}</option>
                    {% endfor %}
                </select>
            {% endif %}
        </div>
    {% endfor %}

    <button class="btn btn-sm custom-enviar" type="submit">Enviar Respuestas</button>
</form>